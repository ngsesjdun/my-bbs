const _0x43743e=_0x22ee;(function(_0x171499,_0x12d04d){const _0x245eab=_0x22ee,_0x2c3c1b=_0x171499();while(!![]){try{const _0x5521b9=parseInt(_0x245eab(0x10f))/0x1*(-parseInt(_0x245eab(0x10e))/0x2)+parseInt(_0x245eab(0xbd))/0x3*(parseInt(_0x245eab(0xab))/0x4)+-parseInt(_0x245eab(0xe0))/0x5+-parseInt(_0x245eab(0xb1))/0x6*(parseInt(_0x245eab(0xc1))/0x7)+parseInt(_0x245eab(0xa1))/0x8+parseInt(_0x245eab(0xd3))/0x9*(parseInt(_0x245eab(0xcc))/0xa)+-parseInt(_0x245eab(0xa0))/0xb;if(_0x5521b9===_0x12d04d)break;else _0x2c3c1b['push'](_0x2c3c1b['shift']());}catch(_0x3f2a59){_0x2c3c1b['push'](_0x2c3c1b['shift']());}}}(_0x5955,0xc2137));import{createClient}from'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';function _0x5955(){const _0x1b1493=['res-','14188460ufkszH','12406520mfoiLG','thread-title','post-body','div','floor','fromCharCode','encode','subtle','preventDefault','parse','119564lpHVlc','replaceState','trim','search','bbsUserId','scrollIntoView','132hfwIDm','created_at','post-message','match','display','res-link','bbsUserIdDate','thread-view','投稿失敗','block','名無し','error','156sRCgfC','res','連投は3秒空けてください','----','104594wjtvrk','getElementById','thread_id','location','getDay','smooth','contains','title','5分以内にスレッドは8回しか作れません','apply','target','10JlcdlU','content',']</span>','thread-name-input','1px\x20solid\x20#000','name-nanashi','?thread=','2404701oxicjg','pathname','getFullYear','\x22\x20target=\x22_blank\x22\x20rel=\x22noopener\x20noreferrer\x22>','order','list-view','textContent','<span\x20class=\x22res-link\x22\x20data-res=\x22','innerHTML','getMinutes','now','insert','value','82830nyESeg','&#39;','sort','createTextNode','getMonth','4px','dataset','refresh-posts','</a>','getHours','appendChild','addEventListener','getDate','thread-title-input','タイトルと本文を入力','id,title','border','get','&amp;','thread-body-input','SHA-256','split','<a\x20href=\x22','margin','スレ作成失敗','padding','maybeSingle','本文は200文字までです','stringify','&quot;','padStart','limit','eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imh3amRxcmJlYWh1eGtpZ291ZGZ5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU2MDkwMjYsImV4cCI6MjA3MTE4NTAyNn0.-5h-SQ5Vns7cNBZTaVTw14xGf-00IHnhjXTluZiUU-U','send','toISOString','&gt;','from','posts','back-top','threads','\x22>[>>','filter','href','thread','includes','https://hwjdqrbeahuxkigoudfy.supabase.co','2aYHUdE','942251iexvPb','createElement','replace','2px\x200','select','click','getItem','style','setItem','has','#res-','&lt;','slice','threadHistory','length','none','className'];_0x5955=function(){return _0x1b1493;};return _0x5955();}const SUPABASE_URL=_0x43743e(0x10d),MOZI=_0x43743e(0x100),db=createClient(SUPABASE_URL,MOZI);function escapeHTML(_0x1c078b){const _0x1f583e=_0x43743e;return _0x1c078b[_0x1f583e(0x90)](/[&<>'"]/g,_0x4d31ba=>({'&':_0x1f583e(0xf2),'<':_0x1f583e(0x99),'>':_0x1f583e(0x103),'\x27':_0x1f583e(0xe1),'\x22':_0x1f583e(0xfd)}[_0x4d31ba]));}function fmt(_0x2ca894){const _0xb73734=_0x43743e;if(!_0x2ca894)return'';const _0x1daec3=new Date(_0x2ca894);if(isNaN(_0x1daec3))return'';const _0x2c4d04=['日','月','火','水','木','金','土'][_0x1daec3[_0xb73734(0xc5)]()],_0x4693ca=(_0x270423,_0x209caa=0x2)=>String(_0x270423)[_0xb73734(0xfe)](_0x209caa,'0');return _0x1daec3[_0xb73734(0xd5)]()+'/'+_0x4693ca(_0x1daec3[_0xb73734(0xe4)]()+0x1)+'/'+_0x4693ca(_0x1daec3[_0xb73734(0xec)]())+'('+_0x2c4d04+')\x20'+_0x4693ca(_0x1daec3[_0xb73734(0xe9)]())+':'+_0x4693ca(_0x1daec3[_0xb73734(0xdc)]())+':'+_0x4693ca(_0x1daec3['getSeconds']());}function generateDailyId(){const _0xac18c7=_0x43743e,_0x2d9b19=new Date()[_0xac18c7(0x102)]()['slice'](0x0,0xa),_0x1dcd4b=localStorage[_0xac18c7(0x94)](_0xac18c7(0xaf)),_0xcc8a41=localStorage[_0xac18c7(0x94)](_0xac18c7(0xb7));if(_0x1dcd4b&&_0xcc8a41===_0x2d9b19)return _0x1dcd4b;const _0x3a0127='ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';let _0x5ebe87='';for(let _0x491c6a=0x0;_0x491c6a<0x4;_0x491c6a++)_0x5ebe87+=_0x3a0127['charAt'](Math[_0xac18c7(0xa5)](Math['random']()*_0x3a0127[_0xac18c7(0x9c)]));return localStorage['setItem'](_0xac18c7(0xaf),_0x5ebe87),localStorage[_0xac18c7(0x96)](_0xac18c7(0xb7),_0x2d9b19),_0x5ebe87;}async function generateTripKey(_0x32b0c3){const _0x5135dc=_0x43743e,_0x403689=new TextEncoder()[_0x5135dc(0xa7)](_0x32b0c3),_0x5ef65a=await crypto[_0x5135dc(0xa8)]['digest'](_0x5135dc(0xf4),_0x403689),_0x103902=Array['from'](new Uint8Array(_0x5ef65a)),_0x508f3e=btoa(String[_0x5135dc(0xa6)][_0x5135dc(0xca)](null,_0x103902));return _0x508f3e[_0x5135dc(0x90)](/[^A-Za-z0-9]/g,'')[_0x5135dc(0x9a)](0x0,0xa);}async function parseName(_0x431b54){const _0x371a2e=_0x43743e,_0x230776=(_0x431b54||'')[_0x371a2e(0xad)]();if(!_0x230776)return _0x371a2e(0xbb);if(_0x230776[_0x371a2e(0x10c)]('#')){const [_0x2de642,_0x16d34e]=_0x230776[_0x371a2e(0xf5)]('#'),_0x24638c=(_0x2de642||_0x371a2e(0xbb))[_0x371a2e(0xad)]();if(_0x16d34e){const _0x1781bd=await generateTripKey(_0x16d34e);return _0x24638c+'◆'+_0x1781bd;}return _0x24638c;}if(_0x230776[_0x371a2e(0x10c)]('◆'))return _0x230776[_0x371a2e(0xf5)]('◆')[0x0]||'名無し';return _0x230776;}function parseDecorations(_0x2ad9f6){const _0x315e76=_0x43743e;return _0x2ad9f6=_0x2ad9f6[_0x315e76(0x90)](/\[([^\]]+)\]\((https?:\/\/[^\s)]+)\)/g,(_0x101cb4,_0x36b906,_0x3371a1)=>_0x315e76(0xf6)+_0x3371a1+_0x315e76(0xd6)+escapeHTML(_0x36b906)+_0x315e76(0xe8)),_0x2ad9f6=_0x2ad9f6['replace'](/(https?:\/\/[^\s<>"']+)/g,_0x3884d5=>_0x315e76(0xf6)+_0x3884d5+'\x22\x20target=\x22_blank\x22\x20rel=\x22noopener\x20noreferrer\x22>'+escapeHTML(_0x3884d5)+_0x315e76(0xe8)),_0x2ad9f6=_0x2ad9f6['replace'](/\[>>(\d+)\]/g,(_0x471fb7,_0x1030ab)=>_0x315e76(0xda)+_0x1030ab+_0x315e76(0x108)+_0x1030ab+_0x315e76(0xce)),_0x2ad9f6;}const listView=document[_0x43743e(0xc2)](_0x43743e(0xd8)),threadBox=document[_0x43743e(0xc2)]('thread-box'),postsEl=document[_0x43743e(0xc2)]('posts'),viewWrap=document[_0x43743e(0xc2)](_0x43743e(0xb8)),viewTitle=document['getElementById'](_0x43743e(0xa2)),newTitle=document[_0x43743e(0xc2)](_0x43743e(0xed)),newBody=document[_0x43743e(0xc2)](_0x43743e(0xf3)),newName=document['getElementById'](_0x43743e(0xcf)),btnCreate=document['getElementById']('create-thread'),inputMsg=document[_0x43743e(0xc2)](_0x43743e(0xb3)),inputName=document[_0x43743e(0xc2)]('post-name'),btnSend=document[_0x43743e(0xc2)](_0x43743e(0x101)),btnBack=document['getElementById']('back'),btnBackTop=document['getElementById'](_0x43743e(0x106)),btnRefreshThreads=document[_0x43743e(0xc2)]('refresh-threads'),btnRefreshPosts=document[_0x43743e(0xc2)](_0x43743e(0xe7));let currentThreadId=null,lastPostTime=0x0,threadHistory=JSON[_0x43743e(0xaa)](localStorage['getItem']('threadHistory')||'[]');const PREFIX_RE=/^\[([A-Z0-9]{4})\](?:\[([^\]]+)\])?\s*/;async function loadThreads(){const _0x214b2d=_0x43743e,{data:_0xa09913,error:_0x2d0823}=await db[_0x214b2d(0x104)](_0x214b2d(0x107))[_0x214b2d(0x92)]('id,title,created_at,posts(*)');if(_0x2d0823){console[_0x214b2d(0xbc)](_0x2d0823);return;}_0xa09913[_0x214b2d(0xe2)]((_0x26d8bb,_0x3a0f90)=>{const _0x126cc5=_0x214b2d,_0x48cb23=_0x26d8bb[_0x126cc5(0x105)][_0x126cc5(0x9c)]>0x0?new Date(_0x26d8bb[_0x126cc5(0x105)][_0x26d8bb['posts']['length']-0x1][_0x126cc5(0xb2)]):new Date(_0x26d8bb[_0x126cc5(0xb2)]),_0x4a5809=_0x3a0f90[_0x126cc5(0x105)]['length']>0x0?new Date(_0x3a0f90['posts'][_0x3a0f90[_0x126cc5(0x105)][_0x126cc5(0x9c)]-0x1][_0x126cc5(0xb2)]):new Date(_0x3a0f90[_0x126cc5(0xb2)]);return _0x4a5809-_0x48cb23;}),threadBox[_0x214b2d(0xdb)]='';for(const _0x36b1bc of _0xa09913){const _0x5931ce=document[_0x214b2d(0x110)](_0x214b2d(0xa4));_0x5931ce[_0x214b2d(0x95)][_0x214b2d(0xf0)]=_0x214b2d(0xd0),_0x5931ce[_0x214b2d(0x95)][_0x214b2d(0xf7)]=_0x214b2d(0x91),_0x5931ce['style'][_0x214b2d(0xf9)]=_0x214b2d(0xe5);const _0x2a3596=document['createElement']('a');_0x2a3596[_0x214b2d(0x10a)]=_0x214b2d(0xd2)+_0x36b1bc['id'],_0x2a3596[_0x214b2d(0xdb)]=escapeHTML(_0x36b1bc[_0x214b2d(0xc8)])+'\x20('+_0x36b1bc[_0x214b2d(0x105)][_0x214b2d(0x9c)]+')',_0x2a3596[_0x214b2d(0xeb)](_0x214b2d(0x93),_0x445d8e=>{const _0x33b1cc=_0x214b2d;_0x445d8e[_0x33b1cc(0xa9)](),openThread(Number(_0x36b1bc['id']),_0x36b1bc[_0x33b1cc(0xc8)]);}),_0x5931ce['appendChild'](_0x2a3596);if(_0x36b1bc['posts']&&_0x36b1bc[_0x214b2d(0x105)][_0x214b2d(0x9c)]>0x0){const _0x1f9c34=_0x36b1bc[_0x214b2d(0x105)][_0x214b2d(0x9a)]()[_0x214b2d(0xe2)]((_0x5ac4ea,_0x3137c7)=>new Date(_0x5ac4ea[_0x214b2d(0xb2)])-new Date(_0x3137c7['created_at']))[0x0],_0x1066f3=document['createElement']('div');_0x1066f3[_0x214b2d(0x9e)]='thread-first',_0x1066f3['textContent']=(_0x1f9c34['content']||'')['replace'](PREFIX_RE,''),_0x5931ce['appendChild'](_0x1066f3);}threadBox[_0x214b2d(0xea)](_0x5931ce);}listView[_0x214b2d(0x95)][_0x214b2d(0xb5)]='block';}btnCreate[_0x43743e(0xeb)]('click',async()=>{const _0x24dbd9=_0x43743e,_0x5aa65=Date[_0x24dbd9(0xdd)]();threadHistory=threadHistory[_0x24dbd9(0x109)](_0x3f052e=>_0x5aa65-_0x3f052e<0x5*0x3c*0x3e8);if(threadHistory['length']>=0x8){alert(_0x24dbd9(0xc9));return;}const _0x3eddc4=newTitle[_0x24dbd9(0xdf)]['trim'](),_0x19a247=newBody[_0x24dbd9(0xdf)][_0x24dbd9(0xad)](),_0x42c0cf=newName[_0x24dbd9(0xdf)][_0x24dbd9(0xad)]();if(!_0x3eddc4||!_0x19a247){alert(_0x24dbd9(0xee));return;}const _0x4239ee=await parseName(_0x42c0cf),{data:_0x1359c2,error:_0x1ea43c}=await db[_0x24dbd9(0x104)]('threads')[_0x24dbd9(0xde)]([{'title':_0x3eddc4}])['select']()[_0x24dbd9(0xff)](0x1)[_0x24dbd9(0xfa)]();if(_0x1ea43c){console[_0x24dbd9(0xbc)](_0x1ea43c),alert(_0x24dbd9(0xf8));return;}const _0x5abdd4=Number(_0x1359c2['id']),_0xc72f63=generateDailyId(),_0x37e66e='['+_0xc72f63+']['+_0x4239ee+']\x20'+_0x19a247,{error:_0x393530}=await db[_0x24dbd9(0x104)]('posts')[_0x24dbd9(0xde)]([{'thread_id':_0x5abdd4,'content':_0x37e66e}]);if(_0x393530){console['error'](_0x393530),alert('初回本文投稿失敗');return;}threadHistory['push'](_0x5aa65),localStorage[_0x24dbd9(0x96)](_0x24dbd9(0x9b),JSON[_0x24dbd9(0xfc)](threadHistory)),newTitle[_0x24dbd9(0xdf)]='',newBody[_0x24dbd9(0xdf)]='',newName[_0x24dbd9(0xdf)]='',await loadThreads(),openThread(_0x5abdd4,_0x3eddc4);});function _0x22ee(_0xc2428f,_0x307cb1){const _0x59557d=_0x5955();return _0x22ee=function(_0x22eed6,_0x5d29f2){_0x22eed6=_0x22eed6-0x90;let _0x3120df=_0x59557d[_0x22eed6];return _0x3120df;},_0x22ee(_0xc2428f,_0x307cb1);}async function openThread(_0x3e2476,_0x251694){const _0x4b6572=_0x43743e;currentThreadId=_0x3e2476,viewTitle[_0x4b6572(0xd9)]=_0x251694,history[_0x4b6572(0xac)](null,null,'?thread='+_0x3e2476),listView[_0x4b6572(0x95)]['display']=_0x4b6572(0x9d),viewWrap[_0x4b6572(0x95)][_0x4b6572(0xb5)]=_0x4b6572(0xba),await loadPosts();}async function loadPosts(){const _0x4d98a9=_0x43743e;if(!currentThreadId)return;const {data:_0x1220d4,error:_0x5c75a6}=await db[_0x4d98a9(0x104)](_0x4d98a9(0x105))['select']('*')['eq'](_0x4d98a9(0xc3),currentThreadId)[_0x4d98a9(0xd7)]('created_at',{'ascending':!![]});if(_0x5c75a6){console[_0x4d98a9(0xbc)](_0x5c75a6);return;}postsEl[_0x4d98a9(0xdb)]='',(_0x1220d4||[])['forEach']((_0x2616c4,_0x368829)=>{const _0x26af93=_0x4d98a9,_0x1214f3=document[_0x26af93(0x110)]('div');_0x1214f3[_0x26af93(0x9e)]='post',_0x1214f3['id']=_0x26af93(0x9f)+(_0x368829+0x1);let _0x56771e=_0x26af93(0xbb),_0x18a3cd=_0x26af93(0xc0);const _0x1e55e9=(_0x2616c4[_0x26af93(0xcd)]||'')[_0x26af93(0xb4)](PREFIX_RE);_0x1e55e9&&(_0x18a3cd=_0x1e55e9[0x1]||_0x18a3cd,_0x56771e=_0x1e55e9[0x2]&&_0x1e55e9[0x2]['trim']()?_0x1e55e9[0x2][_0x26af93(0xad)]():_0x26af93(0xbb));const _0x362cfe=(_0x2616c4['content']||'')[_0x26af93(0x90)](PREFIX_RE,''),_0x5428d5=document[_0x26af93(0x110)]('div');_0x5428d5[_0x26af93(0x9e)]=_0x26af93(0xa3),_0x5428d5[_0x26af93(0xdb)]=parseDecorations(escapeHTML(_0x362cfe));const _0x397459=document['createElement']('div');_0x397459[_0x26af93(0x9e)]='post-header';const _0x1142a1=document[_0x26af93(0x110)]('a');_0x1142a1[_0x26af93(0x10a)]=_0x26af93(0x98)+(_0x368829+0x1),_0x1142a1[_0x26af93(0xe6)]['res']=_0x368829+0x1,_0x1142a1[_0x26af93(0x9e)]=_0x26af93(0xb6),_0x1142a1[_0x26af93(0xd9)]='['+(_0x368829+0x1)+']';const _0x578221=document[_0x26af93(0x110)]('span');_0x578221[_0x26af93(0xd9)]=_0x56771e;if(_0x56771e==='名無し')_0x578221['className']=_0x26af93(0xd1);_0x397459[_0x26af93(0xea)](_0x1142a1),_0x397459['appendChild'](document['createTextNode']('：')),_0x397459[_0x26af93(0xea)](_0x578221),_0x397459['appendChild'](document[_0x26af93(0xe3)]('：'+fmt(_0x2616c4[_0x26af93(0xb2)])+'\x20ID:'+_0x18a3cd)),_0x1214f3['appendChild'](_0x397459),_0x1214f3[_0x26af93(0xea)](_0x5428d5),postsEl[_0x26af93(0xea)](_0x1214f3);});}btnSend[_0x43743e(0xeb)]('click',async()=>{const _0x50c4a7=_0x43743e,_0x3a2fe4=Date[_0x50c4a7(0xdd)]();if(_0x3a2fe4-lastPostTime<0xbb8){alert(_0x50c4a7(0xbf));return;}if(!currentThreadId)return;let _0xd49aed=inputMsg['value'][_0x50c4a7(0xad)]();if(!_0xd49aed)return;if(_0xd49aed[_0x50c4a7(0x9c)]>0xc8){alert(_0x50c4a7(0xfb));return;}const _0x21e107=await parseName(inputName[_0x50c4a7(0xdf)][_0x50c4a7(0xad)]()),_0x52e114=generateDailyId(),_0x1cdd1d='['+_0x52e114+']['+_0x21e107+']\x20'+_0xd49aed,{error:_0x443cbd}=await db['from'](_0x50c4a7(0x105))[_0x50c4a7(0xde)]([{'thread_id':currentThreadId,'content':_0x1cdd1d}]);if(_0x443cbd){console[_0x50c4a7(0xbc)](_0x443cbd),alert(_0x50c4a7(0xb9));return;}inputMsg[_0x50c4a7(0xdf)]='',inputName['value']='',lastPostTime=_0x3a2fe4,await loadPosts();}),btnBack[_0x43743e(0xeb)](_0x43743e(0x93),()=>{const _0x4b23e5=_0x43743e;window[_0x4b23e5(0xc4)][_0x4b23e5(0x10a)]=window[_0x4b23e5(0xc4)]['pathname'];}),btnBackTop['addEventListener']('click',()=>{const _0x382c8b=_0x43743e;window[_0x382c8b(0xc4)][_0x382c8b(0x10a)]=window[_0x382c8b(0xc4)][_0x382c8b(0xd4)];}),btnRefreshThreads[_0x43743e(0xeb)](_0x43743e(0x93),async()=>{await loadThreads();}),btnRefreshPosts['addEventListener']('click',async()=>{if(currentThreadId)await loadPosts();}),document['addEventListener'](_0x43743e(0x93),_0x40859d=>{const _0x3e5ad5=_0x43743e;if(_0x40859d[_0x3e5ad5(0xcb)]['classList'][_0x3e5ad5(0xc7)]('res-link')){_0x40859d[_0x3e5ad5(0xa9)]();const _0x4b1998=_0x40859d[_0x3e5ad5(0xcb)]['dataset'][_0x3e5ad5(0xbe)],_0x1cc0c4=document[_0x3e5ad5(0xc2)]('post-message');_0x1cc0c4[_0x3e5ad5(0xdf)]+='>>'+_0x4b1998+'\x0a',_0x1cc0c4['focus']();const _0x239487=document['getElementById'](_0x3e5ad5(0x9f)+_0x4b1998);if(_0x239487)_0x239487[_0x3e5ad5(0xb0)]({'behavior':_0x3e5ad5(0xc6),'block':'start'});}}),await loadThreads();const params=new URLSearchParams(location[_0x43743e(0xae)]);if(params[_0x43743e(0x97)]('thread')){const id=Number(params[_0x43743e(0xf1)](_0x43743e(0x10b))),{data}=await db[_0x43743e(0x104)](_0x43743e(0x107))['select'](_0x43743e(0xef))['eq']('id',id)[_0x43743e(0xfa)]();if(data)openThread(Number(data['id']),data['title']);}
