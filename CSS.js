const _0x2c1a38=_0x2e86;(function(_0x2313ec,_0x10a99a){const _0x283a2a=_0x2e86,_0x531804=_0x2313ec();while(!![]){try{const _0x5bfb02=parseInt(_0x283a2a(0x13b))/0x1*(-parseInt(_0x283a2a(0xd1))/0x2)+-parseInt(_0x283a2a(0x13d))/0x3*(parseInt(_0x283a2a(0x133))/0x4)+parseInt(_0x283a2a(0x12e))/0x5*(parseInt(_0x283a2a(0x129))/0x6)+parseInt(_0x283a2a(0x11c))/0x7*(-parseInt(_0x283a2a(0x128))/0x8)+-parseInt(_0x283a2a(0xf2))/0x9+-parseInt(_0x283a2a(0xdd))/0xa+parseInt(_0x283a2a(0xed))/0xb;if(_0x5bfb02===_0x10a99a)break;else _0x531804['push'](_0x531804['shift']());}catch(_0x29ce58){_0x531804['push'](_0x531804['shift']());}}}(_0x2d3d,0x392d2));import{createClient}from'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';const SUPABASE_URL=_0x2c1a38(0x11b),MOZI=_0x2c1a38(0x146),db=createClient(SUPABASE_URL,MOZI);function escapeHTML(_0x52b53b){const _0x4f5bce=_0x2c1a38;return _0x52b53b[_0x4f5bce(0x10b)](/[&<>'"]/g,_0x541e86=>({'&':_0x4f5bce(0x122),'<':_0x4f5bce(0xe0),'>':_0x4f5bce(0x135),'\x27':'&#39;','\x22':_0x4f5bce(0x142)}[_0x541e86]));}function _0x2e86(_0x334ac9,_0xde99d6){const _0x2d3da1=_0x2d3d();return _0x2e86=function(_0x2e86ae,_0x1ba024){_0x2e86ae=_0x2e86ae-0xcc;let _0x14f45b=_0x2d3da1[_0x2e86ae];return _0x14f45b;},_0x2e86(_0x334ac9,_0xde99d6);}function fmt(_0x2b32c2){const _0xbecf80=_0x2c1a38;if(!_0x2b32c2)return'';const _0x3796d5=new Date(_0x2b32c2);if(isNaN(_0x3796d5))return'';const _0xa4027a=['日','月','火','水','木','金','土'][_0x3796d5[_0xbecf80(0xfa)]()],_0x1fbae1=(_0x4888aa,_0x15d4d3=0x2)=>String(_0x4888aa)[_0xbecf80(0xda)](_0x15d4d3,'0');return _0x3796d5[_0xbecf80(0xf0)]()+'/'+_0x1fbae1(_0x3796d5[_0xbecf80(0xf1)]()+0x1)+'/'+_0x1fbae1(_0x3796d5[_0xbecf80(0x125)]())+'('+_0xa4027a+')\x20'+_0x1fbae1(_0x3796d5[_0xbecf80(0x124)]())+':'+_0x1fbae1(_0x3796d5['getMinutes']())+':'+_0x1fbae1(_0x3796d5[_0xbecf80(0xef)]());}function generateDailyId(){const _0x5a908a=_0x2c1a38,_0x87ae80=new Date()[_0x5a908a(0xea)]()[_0x5a908a(0x110)](0x0,0xa),_0x4b5c12=localStorage[_0x5a908a(0xce)](_0x5a908a(0x12b)),_0x4736bb=localStorage[_0x5a908a(0xce)](_0x5a908a(0xde));if(_0x4b5c12&&_0x4736bb===_0x87ae80)return _0x4b5c12;const _0x49ecbd='ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';let _0x4c96d2='';for(let _0x2a682e=0x0;_0x2a682e<0x4;_0x2a682e++)_0x4c96d2+=_0x49ecbd[_0x5a908a(0x12c)](Math[_0x5a908a(0x11f)](Math[_0x5a908a(0x116)]()*_0x49ecbd['length']));return localStorage['setItem'](_0x5a908a(0x12b),_0x4c96d2),localStorage['setItem'](_0x5a908a(0xde),_0x87ae80),_0x4c96d2;}async function generateTripKey(_0x44f356){const _0x56cb88=_0x2c1a38,_0x22727d=new TextEncoder()[_0x56cb88(0xee)](_0x44f356),_0x47288d=await crypto[_0x56cb88(0x109)][_0x56cb88(0x107)]('SHA-256',_0x22727d),_0x3006fa=Array[_0x56cb88(0xfc)](new Uint8Array(_0x47288d)),_0x1f4067=btoa(String[_0x56cb88(0x106)][_0x56cb88(0x13f)](null,_0x3006fa));return _0x1f4067['replace'](/[^A-Za-z0-9]/g,'')['slice'](0x0,0xa);}async function parseName(_0x51ae5e){const _0x509775=_0x2c1a38,_0x26ea1a=(_0x51ae5e||'')['trim']();if(!_0x26ea1a)return'名無し';if(_0x26ea1a[_0x509775(0x10a)]('#')){const [_0x578d13,_0x443749]=_0x26ea1a[_0x509775(0x105)]('#'),_0x46c00e=(_0x578d13||'名無し')[_0x509775(0x120)]();if(_0x443749){const _0x146e80=await generateTripKey(_0x443749);return _0x46c00e+'◆'+_0x146e80;}return _0x46c00e;}if(_0x26ea1a[_0x509775(0x10a)]('◆'))return _0x26ea1a[_0x509775(0x105)]('◆')[0x0]||_0x509775(0xdf);return _0x26ea1a;}const listView=document[_0x2c1a38(0x12f)](_0x2c1a38(0xe6)),threadBox=document['getElementById']('thread-box'),postsEl=document[_0x2c1a38(0x12f)]('posts'),viewWrap=document[_0x2c1a38(0x12f)](_0x2c1a38(0x127)),viewTitle=document[_0x2c1a38(0x12f)]('thread-title'),newTitle=document[_0x2c1a38(0x12f)](_0x2c1a38(0x139)),newBody=document[_0x2c1a38(0x12f)](_0x2c1a38(0xd7)),newName=document[_0x2c1a38(0x12f)]('thread-name-input'),btnCreate=document[_0x2c1a38(0x12f)]('create-thread'),inputMsg=document[_0x2c1a38(0x12f)](_0x2c1a38(0x147)),inputName=document[_0x2c1a38(0x12f)](_0x2c1a38(0x10f)),btnSend=document['getElementById'](_0x2c1a38(0xe8)),btnBack=document[_0x2c1a38(0x12f)](_0x2c1a38(0xf6)),btnBackTop=document[_0x2c1a38(0x12f)](_0x2c1a38(0xf3)),btnRefreshThreads=document['getElementById'](_0x2c1a38(0x111)),btnRefreshPosts=document['getElementById'](_0x2c1a38(0x117));let currentThreadId=null,lastPostTime=0x0,threadHistory=JSON[_0x2c1a38(0x101)](localStorage[_0x2c1a38(0xce)]('threadHistory')||'[]');const PREFIX_RE=/^\[([A-Z0-9]{4})\](?:\[([^\]]+)\])?\s*/;async function loadThreads(){const _0x11de12=_0x2c1a38,{data:_0x388d94,error:_0x1dadd5}=await db[_0x11de12(0xfc)](_0x11de12(0x113))['select'](_0x11de12(0x10e));if(_0x1dadd5){console['error'](_0x1dadd5);return;}_0x388d94[_0x11de12(0x12d)]((_0x396d31,_0x29832e)=>{const _0x44d24b=_0x11de12,_0xa7446f=_0x396d31['posts'][_0x44d24b(0xd3)]>0x0?new Date(_0x396d31[_0x44d24b(0xe3)][_0x396d31[_0x44d24b(0xe3)][_0x44d24b(0xd3)]-0x1][_0x44d24b(0xfe)]):new Date(_0x396d31[_0x44d24b(0xfe)]),_0x3b6624=_0x29832e[_0x44d24b(0xe3)][_0x44d24b(0xd3)]>0x0?new Date(_0x29832e['posts'][_0x29832e[_0x44d24b(0xe3)][_0x44d24b(0xd3)]-0x1][_0x44d24b(0xfe)]):new Date(_0x29832e['created_at']);return _0x3b6624-_0xa7446f;}),threadBox[_0x11de12(0xe2)]='';for(const _0x455183 of _0x388d94){const _0x4d41fe=document[_0x11de12(0x13c)](_0x11de12(0x10d));_0x4d41fe[_0x11de12(0x141)]['border']=_0x11de12(0xd0),_0x4d41fe[_0x11de12(0x141)][_0x11de12(0xdb)]=_0x11de12(0x13a),_0x4d41fe[_0x11de12(0x141)][_0x11de12(0x148)]=_0x11de12(0xd8);const _0x484c82=document['createElement']('a');_0x484c82[_0x11de12(0xec)]=_0x11de12(0x108)+_0x455183['id'],_0x484c82['innerHTML']=escapeHTML(_0x455183[_0x11de12(0x121)])+'\x20('+_0x455183['posts'][_0x11de12(0xd3)]+')',_0x484c82[_0x11de12(0xf5)]('click',_0x30d7ec=>{const _0xb0c99a=_0x11de12;_0x30d7ec[_0xb0c99a(0x115)](),openThread(Number(_0x455183['id']),_0x455183[_0xb0c99a(0x121)]);}),_0x4d41fe[_0x11de12(0x126)](_0x484c82);if(_0x455183[_0x11de12(0xe3)]&&_0x455183[_0x11de12(0xe3)][_0x11de12(0xd3)]>0x0){const _0x22c7bc=_0x455183['posts'][_0x11de12(0x110)]()[_0x11de12(0x12d)]((_0x2db034,_0x17c562)=>new Date(_0x2db034['created_at'])-new Date(_0x17c562[_0x11de12(0xfe)]))[0x0],_0x447a8d=document[_0x11de12(0x13c)](_0x11de12(0x10d));_0x447a8d[_0x11de12(0x145)]=_0x11de12(0x112),_0x447a8d[_0x11de12(0xf7)]=(_0x22c7bc[_0x11de12(0x144)]||'')['replace'](PREFIX_RE,''),_0x4d41fe[_0x11de12(0x126)](_0x447a8d);}threadBox[_0x11de12(0x126)](_0x4d41fe);}listView[_0x11de12(0x141)][_0x11de12(0xe5)]=_0x11de12(0xd9);}btnCreate[_0x2c1a38(0xf5)](_0x2c1a38(0x123),async()=>{const _0x1a926d=_0x2c1a38,_0x442df7=Date[_0x1a926d(0x100)]();threadHistory=threadHistory[_0x1a926d(0xe4)](_0x58ddba=>_0x442df7-_0x58ddba<0x5*0x3c*0x3e8);if(threadHistory['length']>=0x8){alert(_0x1a926d(0xd4));return;}const _0x3a3753=newTitle[_0x1a926d(0x114)][_0x1a926d(0x120)](),_0x1e350e=newBody[_0x1a926d(0x114)][_0x1a926d(0x120)](),_0x45badb=newName[_0x1a926d(0x114)][_0x1a926d(0x120)]();if(!_0x3a3753||!_0x1e350e){alert(_0x1a926d(0xcc));return;}const _0x381e77=await parseName(_0x45badb),{data:_0x387418,error:_0x30d408}=await db[_0x1a926d(0xfc)](_0x1a926d(0x113))['insert']([{'title':_0x3a3753}])['select']()['limit'](0x1)['maybeSingle']();if(_0x30d408){console[_0x1a926d(0x10c)](_0x30d408),alert(_0x1a926d(0x131));return;}const _0x2ee72e=Number(_0x387418['id']),_0x1b3790=generateDailyId(),_0x45b3d7='['+_0x1b3790+']['+_0x381e77+']\x20'+_0x1e350e,{error:_0x7e21ea}=await db[_0x1a926d(0xfc)]('posts')[_0x1a926d(0x104)]([{'thread_id':_0x2ee72e,'content':_0x45b3d7}]);if(_0x7e21ea){console[_0x1a926d(0x10c)](_0x7e21ea),alert(_0x1a926d(0x119));return;}threadHistory[_0x1a926d(0x12a)](_0x442df7),localStorage['setItem']('threadHistory',JSON[_0x1a926d(0x140)](threadHistory)),newTitle[_0x1a926d(0x114)]='',newBody[_0x1a926d(0x114)]='',newName[_0x1a926d(0x114)]='',await loadThreads(),openThread(_0x2ee72e,_0x3a3753);});async function openThread(_0x2aae39,_0x1c89e1){const _0x536459=_0x2c1a38;currentThreadId=_0x2aae39,viewTitle[_0x536459(0xf7)]=_0x1c89e1,history[_0x536459(0xe1)](null,null,_0x536459(0x108)+_0x2aae39),listView['style']['display']=_0x536459(0xe9),viewWrap[_0x536459(0x141)][_0x536459(0xe5)]=_0x536459(0xd9),await loadPosts();}async function loadPosts(){const _0x27229e=_0x2c1a38;if(!currentThreadId)return;const {data:_0xa346bd,error:_0x31d616}=await db['from'](_0x27229e(0xe3))[_0x27229e(0xfb)]('*')['eq'](_0x27229e(0xdc),currentThreadId)[_0x27229e(0x13e)]('created_at',{'ascending':!![]});if(_0x31d616){console[_0x27229e(0x10c)](_0x31d616);return;}postsEl[_0x27229e(0xe2)]='',(_0xa346bd||[])['forEach']((_0x154232,_0x292b45)=>{const _0x5d38c7=_0x27229e,_0xbb938=document[_0x5d38c7(0x13c)](_0x5d38c7(0x10d));_0xbb938[_0x5d38c7(0x145)]=_0x5d38c7(0xeb);let _0x76733f=_0x5d38c7(0xdf),_0x3935a0=_0x5d38c7(0x11d);const _0x43703f=(_0x154232[_0x5d38c7(0x144)]||'')['match'](PREFIX_RE);_0x43703f&&(_0x3935a0=_0x43703f[0x1]||_0x3935a0,_0x76733f=_0x43703f[0x2]&&_0x43703f[0x2]['trim']()?_0x43703f[0x2]['trim']():_0x5d38c7(0xdf));const _0x29e153=(_0x154232[_0x5d38c7(0x144)]||'')[_0x5d38c7(0x10b)](PREFIX_RE,''),_0x560e17=document[_0x5d38c7(0x13c)](_0x5d38c7(0x10d));_0x560e17[_0x5d38c7(0x145)]=_0x5d38c7(0xfd),_0x560e17[_0x5d38c7(0xf7)]=_0x29e153;const _0x8b3f7e=document[_0x5d38c7(0x13c)](_0x5d38c7(0x10d));_0x8b3f7e['className']=_0x5d38c7(0xd2);const _0x5260ac=document[_0x5d38c7(0x13c)]('a');_0x5260ac[_0x5d38c7(0xec)]=_0x5d38c7(0xd6)+(_0x292b45+0x1),_0x5260ac[_0x5d38c7(0x102)]['res']=_0x292b45+0x1,_0x5260ac[_0x5d38c7(0x145)]='res-link',_0x5260ac[_0x5d38c7(0xf7)]='['+(_0x292b45+0x1)+']';const _0x2bc3b9=document[_0x5d38c7(0x13c)](_0x5d38c7(0x132));_0x2bc3b9['textContent']=_0x76733f;if(_0x76733f===_0x5d38c7(0xdf))_0x2bc3b9['className']=_0x5d38c7(0x138);_0x8b3f7e[_0x5d38c7(0x126)](_0x5260ac),_0x8b3f7e['appendChild'](document[_0x5d38c7(0x130)]('：')),_0x8b3f7e[_0x5d38c7(0x126)](_0x2bc3b9),_0x8b3f7e[_0x5d38c7(0x126)](document['createTextNode']('：'+fmt(_0x154232[_0x5d38c7(0xfe)])+_0x5d38c7(0xd5)+_0x3935a0)),_0xbb938[_0x5d38c7(0x126)](_0x8b3f7e),_0xbb938[_0x5d38c7(0x126)](_0x560e17),postsEl[_0x5d38c7(0x126)](_0xbb938);});}btnSend[_0x2c1a38(0xf5)](_0x2c1a38(0x123),async()=>{const _0x4bb686=_0x2c1a38,_0x895013=Date[_0x4bb686(0x100)]();if(_0x895013-lastPostTime<0xbb8){alert('連投は3秒空けてください');return;}if(!currentThreadId)return;let _0x1414f8=inputMsg[_0x4bb686(0x114)][_0x4bb686(0x120)]();if(!_0x1414f8)return;if(_0x1414f8[_0x4bb686(0xd3)]>0xc8){alert(_0x4bb686(0xcd));return;}const _0x97c4d6=await parseName(inputName[_0x4bb686(0x114)]['trim']()),_0x218a94=generateDailyId(),_0x1b910a='['+_0x218a94+']['+_0x97c4d6+']\x20'+_0x1414f8,{error:_0x3ae554}=await db[_0x4bb686(0xfc)](_0x4bb686(0xe3))[_0x4bb686(0x104)]([{'thread_id':currentThreadId,'content':_0x1b910a}]);if(_0x3ae554){console[_0x4bb686(0x10c)](_0x3ae554),alert(_0x4bb686(0xe7));return;}inputMsg['value']='',inputName[_0x4bb686(0x114)]='',lastPostTime=_0x895013,await loadPosts();}),btnBack['addEventListener'](_0x2c1a38(0x123),()=>{const _0x79c925=_0x2c1a38;window[_0x79c925(0xf4)][_0x79c925(0xec)]=window[_0x79c925(0xf4)][_0x79c925(0xf9)];}),btnBackTop[_0x2c1a38(0xf5)](_0x2c1a38(0x123),()=>{const _0x485844=_0x2c1a38;window[_0x485844(0xf4)][_0x485844(0xec)]=window['location'][_0x485844(0xf9)];}),btnRefreshThreads[_0x2c1a38(0xf5)](_0x2c1a38(0x123),async()=>{await loadThreads();}),btnRefreshPosts[_0x2c1a38(0xf5)](_0x2c1a38(0x123),async()=>{if(currentThreadId)await loadPosts();}),document[_0x2c1a38(0xf5)](_0x2c1a38(0x123),_0xb3f0df=>{const _0x46cc36=_0x2c1a38;if(_0xb3f0df[_0x46cc36(0x134)][_0x46cc36(0x11a)]['contains'](_0x46cc36(0x11e))){_0xb3f0df['preventDefault']();const _0x58751d=_0xb3f0df['target'][_0x46cc36(0x102)][_0x46cc36(0x118)],_0x27e656=document[_0x46cc36(0x12f)](_0x46cc36(0x147));_0x27e656[_0x46cc36(0x114)]+='>>'+_0x58751d+'\x0a',_0x27e656[_0x46cc36(0xf8)]();}}),await loadThreads();const params=new URLSearchParams(location[_0x2c1a38(0x137)]);if(params[_0x2c1a38(0xff)](_0x2c1a38(0x103))){const id=Number(params[_0x2c1a38(0x143)](_0x2c1a38(0x103))),{data}=await db[_0x2c1a38(0xfc)](_0x2c1a38(0x113))[_0x2c1a38(0xfb)](_0x2c1a38(0xcf))['eq']('id',id)[_0x2c1a38(0x136)]();if(data)openThread(Number(data['id']),data[_0x2c1a38(0x121)]);}function _0x2d3d(){const _0x5105ff=['1px\x20solid\x20#000','2jwrhUk','post-header','length','5分以内にスレッドは8回しか作れません','\x20ID:','#res-','thread-body-input','4px','block','padStart','margin','thread_id','1074960WyITpF','bbsUserIdDate','名無し','&lt;','replaceState','innerHTML','posts','filter','display','list-view','投稿失敗','send','none','toISOString','post','href','6100292lntZru','encode','getSeconds','getFullYear','getMonth','128142yUAvEe','back-top','location','addEventListener','back','textContent','focus','pathname','getDay','select','from','post-body','created_at','has','now','parse','dataset','thread','insert','split','fromCharCode','digest','?thread=','subtle','includes','replace','error','div','id,title,created_at,posts(*)','post-name','slice','refresh-threads','thread-first','threads','value','preventDefault','random','refresh-posts','res','初回本文投稿失敗','classList','https://hwjdqrbeahuxkigoudfy.supabase.co','163989XiWSAN','----','res-link','floor','trim','title','&amp;','click','getHours','getDate','appendChild','thread-view','72cvGBwk','312HkEwPt','push','bbsUserId','charAt','sort','19905KJBWcb','getElementById','createTextNode','スレ作成失敗','span','8HZcScN','target','&gt;','maybeSingle','search','name-nanashi','thread-title-input','2px\x200','173039aGZqSF','createElement','32661SrfJXa','order','apply','stringify','style','&quot;','get','content','className','eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imh3amRxcmJlYWh1eGtpZ291ZGZ5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU2MDkwMjYsImV4cCI6MjA3MTE4NTAyNn0.-5h-SQ5Vns7cNBZTaVTw14xGf-00IHnhjXTluZiUU-U','post-message','padding','タイトルと本文を入力','本文は200文字までです','getItem','id,title'];_0x2d3d=function(){return _0x5105ff;};return _0x2d3d();}
