<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>なんI</title>
<style>
button {
  width: 100%;
  padding: 10px 0;
  font-size: 1em;
  font-weight: normal;
  text-align: center;
  cursor: pointer;
  margin-top: 4px;
  border-radius: 4px;
  border: 1px solid #000;
  color: #666666;
  background-color: #fff;
}
.post {
  border-bottom: 1px solid #666;
  margin: 6px 0;
  padding: 4px 2px;
}
.post-header {
  font-weight: bold;
}
.post-body {
  margin-left: 1em;
  white-space: pre-wrap;
}
.thread-first {
  margin-left: 1em;
  color: #444;
  font-size: 0.9em;
}
#thread-title {
  color: blue;
  font-weight: bold;
  font-size: 27px;
  margin-bottom: 4px;
}
</style>
</head>
<body bgcolor="#FFFFFF" text="#000000">

<div id="header" style="font-weight:bold; font-size:25px; margin:8px 0;">なんでも実況ジュピター</div>
<font size="2">追加して欲しい要素・苦情は運営ですと言うスレから　<a href="https://ngsesjdun.github.io/my-bbs/?thread=216">ここ</a><br>更新しなきゃいけないけどレスがあれば上がります</font>
<hr>

<div id="wrap">
  <div id="list-view">
    <div id="new-thread">
      <input id="thread-title-input" type="text" placeholder="スレッドタイトル" /><br>
      <textarea id="thread-body-input" placeholder="本文（最初のレス）" rows="2" style="width:100%;"></textarea>
      <button id="create-thread" type="button">スレ作成</button>
    </div>
    <font size="2">
      <button id="refresh-threads" style="color:#fff; background-color:#0077ff; ">スレを更新</button>
    </font>
    <div id="thread-box"></div>
  </div>

  <div id="thread-view" style="display:none; margin-top:8px;">
    <div id="thread-title"></div>
    <button id="back-top" type="button">戻る</button>
    <div id="posts"></div>
    <div id="post-form-wrap" style="margin-top:8px;">
      <form id="post-form" onsubmit="return false;">
        <textarea id="post-message" placeholder="本文（改行できます）" rows="3" style="width:100%;"></textarea>
        <button id="send" type="button">投稿</button>
        <button id="back" type="button" style="background-color:#fff;">スレ一覧へ</button>
        <button id="refresh-posts" type="button" style="color:#fff; background-color:blue; ">レス更新</button>
      </form>
    </div>
  </div>
</div>

<script type="module">
function _0x5a7e(){const _0x13da7e=['名無し','style','id,title','replace','&quot;','maybeSingle','value','padStart','sort','match','761910UXYXGK','forEach','select','now','length','getSeconds','createTextNode','bbsUserId','&amp;','連投は2秒空けてください','getItem','<a\x20href=\x22','thread_id','innerHTML','order','getMinutes','addEventListener','setItem','619926GeCFZW','https://owopzgeliyhgxpnywscy.supabase.co','from','thread','スレ作成失敗','&#39;','4px','green','replaceState','28seIbMN','appendChild','send','public','1px\x20solid\x20#000','className','location','ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789','posts','error','div','getFullYear','1628904wxTuxJ','----','?thread=','href','getDate','thread-title','99595kAPHqn','\x22\x20target=\x22_blank\x22\x20rel=\x22noopener\x20noreferrer\x22>','display','trim','getMonth','id,content,created_at,thread_id','span','本文を入れて','</a>','padding','\x20ID:','random','created_at','https://ngsesjdun.github.io/my-bbs','getDay','id,title,created_at,posts(created_at,content)','limit','textContent','block','thread-body-input','159099jLQtbq','タイトルを入れて','&gt;','click','4981760nvEzLQ','content','bbsUserIdDate','floor','threads','1em','7MXdNhn','createElement','title','ceil','has','marginLeft','thread-view','getHours','getElementById','投稿失敗','get','list-view','margin','thread-title-input','public:posts','1470780yROSsb','insert','<br>','new','slice','本文は200文字までです','2IyotyC'];_0x5a7e=function(){return _0x13da7e;};return _0x5a7e();}const _0x57f78e=_0x4fb5;(function(_0x19826c,_0x2a3186){const _0x32539b=_0x4fb5,_0x327971=_0x19826c();while(!![]){try{const _0x10818b=parseInt(_0x32539b(0x18d))/0x1*(-parseInt(_0x32539b(0x1ac))/0x2)+-parseInt(_0x32539b(0x15e))/0x3+-parseInt(_0x32539b(0x167))/0x4*(-parseInt(_0x32539b(0x179))/0x5)+-parseInt(_0x32539b(0x14c))/0x6+-parseInt(_0x32539b(0x197))/0x7*(parseInt(_0x32539b(0x173))/0x8)+parseInt(_0x32539b(0x1a6))/0x9+parseInt(_0x32539b(0x191))/0xa;if(_0x10818b===_0x2a3186)break;else _0x327971['push'](_0x327971['shift']());}catch(_0x476735){_0x327971['push'](_0x327971['shift']());}}}(_0x5a7e,0x198f2));import{createClient}from'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';const SUPABASE_URL=_0x57f78e(0x15f),MOZI='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im93b3B6Z2VsaXloZ3hwbnl3c2N5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUwNjU3MTYsImV4cCI6MjA3MDY0MTcxNn0.0zUkNS8KeXULcl7HxoYQvbD7J0FTf3Z9-4Xq4rpDdX8',db=createClient(SUPABASE_URL,MOZI);function escapeHTML(_0x333e25){const _0x296171=_0x57f78e;return _0x333e25[_0x296171(0x1b0)](/[&<>"']/g,_0x5da1fc=>({'&':_0x296171(0x154),'<':'&lt;','>':_0x296171(0x18f),'\x22':_0x296171(0x1b1),'\x27':_0x296171(0x163)}[_0x5da1fc]));}function parseDecorations(_0xf99e9d){const _0x379b4b=_0x57f78e;return _0xf99e9d=_0xf99e9d[_0x379b4b(0x1b0)](/\[([^\]]+)\]\((https?:\/\/[^\s)]+)\)/g,(_0x4b9a81,_0x18941c,_0x28d3ca)=>{const _0x5b2496=_0x379b4b;return _0x5b2496(0x157)+_0x28d3ca+_0x5b2496(0x17a)+escapeHTML(_0x18941c)+_0x5b2496(0x181);}),_0xf99e9d=_0xf99e9d[_0x379b4b(0x1b0)](/(https?:\/\/[^\s<>"']+)/g,_0x10f4fe=>{const _0x5139f5=_0x379b4b;return _0x5139f5(0x157)+_0x10f4fe+_0x5139f5(0x17a)+escapeHTML(_0x10f4fe)+_0x5139f5(0x181);}),_0xf99e9d;}function generateDailyId(){const _0xbc7de8=_0x57f78e,_0x525a59=new Date()['toISOString']()[_0xbc7de8(0x1aa)](0x0,0xa),_0x543e88=localStorage[_0xbc7de8(0x156)](_0xbc7de8(0x153)),_0x19f2a4=localStorage['getItem'](_0xbc7de8(0x193));if(_0x543e88&&_0x19f2a4===_0x525a59)return _0x543e88;const _0x12de4a=_0xbc7de8(0x16e);let _0x2cb52f='';for(let _0x3bac78=0x0;_0x3bac78<0x4;_0x3bac78++)_0x2cb52f+=_0x12de4a['charAt'](Math[_0xbc7de8(0x194)](Math[_0xbc7de8(0x184)]()*_0x12de4a[_0xbc7de8(0x150)]));return localStorage['setItem'](_0xbc7de8(0x153),_0x2cb52f),localStorage[_0xbc7de8(0x15d)]('bbsUserIdDate',_0x525a59),_0x2cb52f;}const listView=document[_0x57f78e(0x19f)](_0x57f78e(0x1a2)),threadBox=document[_0x57f78e(0x19f)]('thread-box'),postsEl=document['getElementById'](_0x57f78e(0x16f)),viewWrap=document[_0x57f78e(0x19f)](_0x57f78e(0x19d)),viewTitle=document[_0x57f78e(0x19f)](_0x57f78e(0x178)),newTitle=document[_0x57f78e(0x19f)](_0x57f78e(0x1a4)),newBody=document[_0x57f78e(0x19f)](_0x57f78e(0x18c)),btnCreate=document[_0x57f78e(0x19f)]('create-thread'),inputMsg=document[_0x57f78e(0x19f)]('post-message'),btnSend=document[_0x57f78e(0x19f)](_0x57f78e(0x169)),btnBack=document[_0x57f78e(0x19f)]('back'),btnBackTop=document[_0x57f78e(0x19f)]('back-top'),btnRefreshThreads=document[_0x57f78e(0x19f)]('refresh-threads'),btnRefreshPosts=document['getElementById']('refresh-posts');let currentThreadId=null,lastPostTime=0x0;function fmt(_0xc78f8e){const _0x43ab7a=_0x57f78e;if(!_0xc78f8e)return'';const _0x5d0e81=_0xc78f8e instanceof Date?_0xc78f8e:new Date(_0xc78f8e);if(isNaN(_0x5d0e81))return'';const _0x4f14ee=['日','月','火','水','木','金','土'][_0x5d0e81[_0x43ab7a(0x187)]()],_0x232730=(_0x7a307d,_0x51c0c3=0x2)=>String(_0x7a307d)[_0x43ab7a(0x1b4)](_0x51c0c3,'0');return _0x5d0e81[_0x43ab7a(0x172)]()+'/'+_0x232730(_0x5d0e81[_0x43ab7a(0x17d)]()+0x1)+'/'+_0x232730(_0x5d0e81[_0x43ab7a(0x177)]())+'('+_0x4f14ee+')\x20'+_0x232730(_0x5d0e81[_0x43ab7a(0x19e)]())+':'+_0x232730(_0x5d0e81[_0x43ab7a(0x15b)]())+':'+_0x232730(_0x5d0e81[_0x43ab7a(0x151)]());}async function loadThreads(){const _0x208595=_0x57f78e,{data:_0x49be1e,error:_0x11bd15}=await db[_0x208595(0x160)](_0x208595(0x195))[_0x208595(0x14e)](_0x208595(0x188));if(_0x11bd15){console['error'](_0x11bd15);return;}_0x49be1e['sort']((_0x158f2a,_0x23184c)=>{const _0x4c0cb1=_0x208595,_0x14cff0=_0x158f2a[_0x4c0cb1(0x16f)][_0x4c0cb1(0x150)]>0x0?new Date(_0x158f2a['posts'][_0x158f2a['posts'][_0x4c0cb1(0x150)]-0x1][_0x4c0cb1(0x185)]):new Date(_0x158f2a['created_at']),_0x5ae7bc=_0x23184c[_0x4c0cb1(0x16f)][_0x4c0cb1(0x150)]>0x0?new Date(_0x23184c[_0x4c0cb1(0x16f)][_0x23184c['posts'][_0x4c0cb1(0x150)]-0x1][_0x4c0cb1(0x185)]):new Date(_0x23184c[_0x4c0cb1(0x185)]);return _0x5ae7bc-_0x14cff0;}),threadBox[_0x208595(0x159)]='';for(const _0x50666c of _0x49be1e){const _0x585d75=document[_0x208595(0x198)](_0x208595(0x171));_0x585d75['style']['border']=_0x208595(0x16b),_0x585d75['style'][_0x208595(0x1a3)]='2px\x200',_0x585d75[_0x208595(0x1ae)][_0x208595(0x182)]=_0x208595(0x164);const _0x57add3=document[_0x208595(0x198)]('a');_0x57add3[_0x208595(0x176)]=_0x208595(0x175)+_0x50666c['id'],_0x57add3[_0x208595(0x159)]=escapeHTML(_0x50666c[_0x208595(0x199)])+('\x20('+_0x50666c[_0x208595(0x16f)][_0x208595(0x150)]+')'),_0x57add3[_0x208595(0x15c)](_0x208595(0x190),_0x2d79d2=>{const _0x3714c3=_0x208595;_0x2d79d2['preventDefault'](),openThread(_0x50666c['id'],_0x50666c[_0x3714c3(0x199)]);}),_0x585d75['appendChild'](_0x57add3);if(_0x50666c['posts']&&_0x50666c['posts'][_0x208595(0x150)]>0x0){const _0x1eb50d=_0x50666c['posts'][_0x208595(0x1b5)]((_0x40e202,_0x16acf1)=>new Date(_0x40e202[_0x208595(0x185)])-new Date(_0x16acf1[_0x208595(0x185)]))[0x0],_0x428ea6=document['createElement'](_0x208595(0x171));_0x428ea6[_0x208595(0x16c)]='thread-first';let _0x374d06=_0x1eb50d['content'][_0x208595(0x1b0)](/^\[[A-Z0-9]{4}\]\s*/,'');const _0x194409=Math[_0x208595(0x19a)](_0x374d06[_0x208595(0x150)]/0x2);_0x374d06=_0x374d06[_0x208595(0x1aa)](0x0,Math['min'](_0x194409,0x23))+(_0x374d06['length']>0x23?'…':''),_0x428ea6['innerHTML']=parseDecorations(_0x374d06),_0x585d75['appendChild'](_0x428ea6);}threadBox['appendChild'](_0x585d75);}listView['style'][_0x208595(0x17b)]=_0x208595(0x18b);}btnCreate['addEventListener'](_0x57f78e(0x190),async()=>{const _0x376b35=_0x57f78e,_0x349a86=newTitle[_0x376b35(0x1b3)][_0x376b35(0x17c)](),_0x2202f8=newBody[_0x376b35(0x1b3)][_0x376b35(0x17c)]();if(!_0x349a86){alert(_0x376b35(0x18e));return;}if(!_0x2202f8){alert(_0x376b35(0x180));return;}const {data:_0x4d66a7,error:_0x28e7b1}=await db[_0x376b35(0x160)](_0x376b35(0x195))['insert']([{'title':_0x349a86}])[_0x376b35(0x14e)]()[_0x376b35(0x189)](0x1)[_0x376b35(0x1b2)]();if(_0x28e7b1){console['error'](_0x28e7b1),alert(_0x376b35(0x162));return;}const _0x32b401=_0x4d66a7['id'],_0x40ec82=generateDailyId(),{error:_0x4f6425}=await db[_0x376b35(0x160)](_0x376b35(0x16f))[_0x376b35(0x1a7)]([{'thread_id':_0x32b401,'content':'['+_0x40ec82+']\x20'+_0x2202f8}]);if(_0x4f6425){console[_0x376b35(0x170)](_0x4f6425),alert('初回本文投稿失敗');return;}newTitle[_0x376b35(0x1b3)]='',newBody['value']='',await loadThreads(),openThread(_0x32b401,_0x349a86);});async function openThread(_0x19a98c,_0x2949cc){const _0x5ab909=_0x57f78e;currentThreadId=_0x19a98c,viewTitle['textContent']=_0x2949cc,history[_0x5ab909(0x166)](null,null,_0x5ab909(0x175)+_0x19a98c),listView['style']['display']='none',viewWrap['style'][_0x5ab909(0x17b)]=_0x5ab909(0x18b),await loadPosts();}async function loadPosts(){const _0xc59d95=_0x57f78e;if(!currentThreadId)return;const {data:_0x1cd74a,error:_0x30e37}=await db[_0xc59d95(0x160)]('posts')[_0xc59d95(0x14e)](_0xc59d95(0x17e))['eq'](_0xc59d95(0x158),currentThreadId)[_0xc59d95(0x15a)](_0xc59d95(0x185),{'ascending':!![]});if(_0x30e37){console[_0xc59d95(0x170)](_0x30e37);return;}postsEl[_0xc59d95(0x159)]='',(_0x1cd74a||[])[_0xc59d95(0x14d)]((_0x2826c0,_0x9504a)=>{const _0x4f1318=_0xc59d95,_0xdf869d=document[_0x4f1318(0x198)]('div');_0xdf869d[_0x4f1318(0x16c)]='post';const _0x527d99=_0x2826c0[_0x4f1318(0x192)][_0x4f1318(0x14b)](/^\[([A-Z0-9]{4})\]\s*/),_0x128ff3=_0x527d99?_0x527d99[0x1]:_0x4f1318(0x174),_0x4fe8c8=_0x527d99?_0x2826c0[_0x4f1318(0x192)][_0x4f1318(0x1b0)](/^\[[A-Z0-9]{4}\]\s*/,''):_0x2826c0[_0x4f1318(0x192)],_0xc9d26a=document[_0x4f1318(0x198)](_0x4f1318(0x171)),_0x54140f=document[_0x4f1318(0x198)](_0x4f1318(0x17f));_0x54140f[_0x4f1318(0x1ae)]['color']=_0x4f1318(0x165),_0x54140f[_0x4f1318(0x18a)]=_0x4f1318(0x1ad),_0xc9d26a[_0x4f1318(0x168)](document[_0x4f1318(0x152)]('['+(_0x9504a+0x1)+']：')),_0xc9d26a[_0x4f1318(0x168)](_0x54140f),_0xc9d26a['appendChild'](document[_0x4f1318(0x152)]('：'+fmt(_0x2826c0[_0x4f1318(0x185)])+_0x4f1318(0x183)+_0x128ff3));const _0x3e1698=document[_0x4f1318(0x198)](_0x4f1318(0x171));_0x3e1698[_0x4f1318(0x159)]=parseDecorations(_0x4fe8c8)[_0x4f1318(0x1b0)](/\n/g,_0x4f1318(0x1a8)),_0x3e1698[_0x4f1318(0x1ae)][_0x4f1318(0x19c)]=_0x4f1318(0x196),_0xdf869d['appendChild'](_0xc9d26a),_0xdf869d[_0x4f1318(0x168)](_0x3e1698),postsEl[_0x4f1318(0x168)](_0xdf869d);});}btnSend[_0x57f78e(0x15c)]('click',async()=>{const _0x11a944=_0x57f78e,_0x3274b7=Date[_0x11a944(0x14f)]();if(_0x3274b7-lastPostTime<0x7d0){alert(_0x11a944(0x155));return;}if(!currentThreadId)return;let _0x312009=inputMsg[_0x11a944(0x1b3)]['trim']();if(!_0x312009)return;if(_0x312009[_0x11a944(0x150)]>0xc8){alert(_0x11a944(0x1ab));return;}const _0x132df2=generateDailyId(),{error:_0x51b24c}=await db[_0x11a944(0x160)](_0x11a944(0x16f))[_0x11a944(0x1a7)]([{'thread_id':currentThreadId,'content':'['+_0x132df2+']\x20'+_0x312009}]);if(_0x51b24c){console[_0x11a944(0x170)](_0x51b24c),alert(_0x11a944(0x1a0));return;}inputMsg['value']='',lastPostTime=_0x3274b7,await loadPosts();}),btnBack[_0x57f78e(0x15c)](_0x57f78e(0x190),()=>{const _0x25fce0=_0x57f78e;window[_0x25fce0(0x16d)][_0x25fce0(0x176)]=_0x25fce0(0x186);}),btnBackTop[_0x57f78e(0x15c)](_0x57f78e(0x190),()=>{const _0x2cd526=_0x57f78e;window['location'][_0x2cd526(0x176)]=_0x2cd526(0x186);}),btnRefreshThreads[_0x57f78e(0x15c)](_0x57f78e(0x190),async()=>{await loadThreads();}),btnRefreshPosts[_0x57f78e(0x15c)]('click',async()=>{if(currentThreadId)await loadPosts();}),db['channel'](_0x57f78e(0x1a5))['on']('postgres_changes',{'event':'*','schema':_0x57f78e(0x16a),'table':_0x57f78e(0x16f)},_0x2dbc35=>{const _0x35fb15=_0x57f78e;if(currentThreadId&&_0x2dbc35[_0x35fb15(0x1a9)][_0x35fb15(0x158)]===currentThreadId)loadPosts();loadThreads();})['subscribe'](),loadThreads();const params=new URLSearchParams(location['search']);function _0x4fb5(_0x310fbf,_0x4713e8){const _0x5a7e5a=_0x5a7e();return _0x4fb5=function(_0x4fb5ae,_0x445039){_0x4fb5ae=_0x4fb5ae-0x14b;let _0x113af=_0x5a7e5a[_0x4fb5ae];return _0x113af;},_0x4fb5(_0x310fbf,_0x4713e8);}if(params[_0x57f78e(0x19b)](_0x57f78e(0x161))){const id=params[_0x57f78e(0x1a1)]('thread');((async()=>{const _0x2cf043=_0x57f78e,{data:_0x43f35b,error:_0x5e7c78}=await db[_0x2cf043(0x160)](_0x2cf043(0x195))[_0x2cf043(0x14e)](_0x2cf043(0x1af))['eq']('id',id)[_0x2cf043(0x1b2)]();if(_0x43f35b)openThread(_0x43f35b['id'],_0x43f35b[_0x2cf043(0x199)]);})());}
</script>
</body>
</html>
